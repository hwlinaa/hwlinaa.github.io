<!DOCTYPE html>
<html lang="zh-HK">

<head>
    <meta property="og:title" content="ç¬¬28å±†é¦™æ¸¯é’å°‘å¹´ç§‘æŠ€å‰µæ–°å¤§è³½ - é ’çå®‰æ’">
    <meta property="og:description" content="è¼¸å…¥åƒè³½ç·¨è™Ÿï¼Œå³æ™‚æŸ¥è©¢æ‚¨çš„é ’çå„€å¼æˆ–å…¸ç¦®å‡ºå¸­æ™‚æ®µã€‚">
    <meta property="og:image" content="https://stic.newgen.org.hk/wp-content/uploads/2021/11/ng-logo-removebg.png">
    <meta property="og:url" content="https://results.stic.newgen.org.hk/">
    <meta property="og:type" content="website">
    <meta name="robots" content="noindex, nofollow">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬28å±†é¦™æ¸¯é’å°‘å¹´ç§‘æŠ€å‰µæ–°å¤§è³½ - é ’çå®‰æ’</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        :root {
            --primary-blue: #0A3D91;
            --accent-orange: #F28C28;
            --bg-color: #F4F7FB;
            --card-bg: #FFFFFF;
            --text-main: #333333;
            --text-muted: #666666;
            --border-radius: 12px;
            --menu-bg: #072a66;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 20px 10px;
            line-height: 1.6;
        }

        /* å°èˆªåˆ—èˆ‡é¸å–®æ¨£å¼ */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 950px;
            margin: 0 auto 20px auto;
            padding: 0 10px;
        }

        .logo-text {
            font-weight: bold;
            color: var(--primary-blue);
            font-size: 1.1rem;
        }

        .menu-btn {
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--primary-blue);
            background: none;
            border: none;
            padding: 5px;
        }

        .side-menu {
            position: fixed;
            top: 0;
            right: -280px;
            width: 260px;
            height: 100%;
            background-color: var(--menu-bg);
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.2);
            transition: right 0.3s ease;
            z-index: 1000;
            padding-top: 60px;
            display: flex;
            flex-direction: column;
        }

        .side-menu.open {
            right: 0;
        }

        .side-menu a {
            padding: 15px 25px;
            text-decoration: none;
            font-size: 1.1rem;
            color: white;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: 0.2s;
        }

        .side-menu a:hover {
            background-color: rgba(255, 255, 255, 0.1);
            padding-left: 35px;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 2rem;
            color: white;
            cursor: pointer;
            background: none;
            border: none;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 900;
            display: none;
        }

        .overlay.show {
            display: block;
        }

        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 950px;
            margin: auto;
            background: var(--card-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.06);
        }

        .header-title {
            text-align: center;
            border-bottom: 2px solid #edf2f7;
            padding-bottom: 20px;
            margin-bottom: 25px;
        }

        .header-title h1 {
            color: var(--primary-blue);
            font-size: 1.6rem;
            margin: 0 0 10px 0;
        }

        .header-title p {
            color: var(--text-muted);
            margin: 0;
            font-size: 1rem;
        }

        .notice-box {
            background-color: #ebf8ff;
            border-left: 5px solid #2b6cb0;
            padding: 15px;
            margin-bottom: 25px;
            color: #2c5282;
            font-size: 0.95rem;
            border-radius: 4px;
        }

        .search-section {
            background: #f8fafc;
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 25px;
            border: 1px solid #e2e8f0;
        }

        .filter-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        .search-group {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        select.form-select {
            padding: 12px;
            font-size: 16px;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            background-color: white;
            color: var(--text-main);
            outline: none;
            cursor: pointer;
            width: 100%;
            max-width: 100%;
        }

        select.prefix-dropdown {
            padding: 12px;
            font-size: 16px;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            background-color: white;
            font-weight: bold;
            color: var(--primary-blue);
            min-width: 90px;
        }

        input.number-input {
            padding: 12px;
            font-size: 16px;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            outline: none;
            flex-grow: 1;
            min-width: 140px;
        }

        button.btn-search,
        button.btn-reset {
            padding: 12px 20px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        button.btn-search {
            background-color: var(--primary-blue);
            color: white;
            flex-grow: 1;
        }

        button.btn-reset {
            background-color: #e2e8f0;
            color: var(--text-main);
        }

        input:focus,
        select:focus {
            border-color: var(--accent-orange);
            box-shadow: 0 0 0 3px rgba(242, 140, 40, 0.2);
        }

        .table-responsive {
            width: 100%;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th,
        td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #edf2f7;
            vertical-align: middle;
        }

        th {
            background-color: #f8fafc;
            color: var(--text-muted);
            font-weight: 600;
        }

        .badge-group {
            display: inline-block;
            background: #f1f5f9;
            color: #475569;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            margin-bottom: 4px;
        }

        /* æ™‚æ®µæ¨™ç±¤æ¨£å¼ */
        .time-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 0.95em;
            white-space: nowrap;
        }

        .badge-am1 {
            background: #DEF7EC;
            color: #03543F;
            border: 1px solid #84E1BC;
        }

        .badge-am2 {
            background: #E1EFFE;
            color: #1E429F;
            border: 1px solid #A4CAFE;
        }

        .badge-pm {
            background: linear-gradient(135deg, #667EEA, #764BA2);
            color: white;
            border: none;
            box-shadow: 0 4px 10px rgba(118, 75, 162, 0.3);
        }

        /* ã€Œè©³æƒ…ç¨å¾Œå…¬ä½ˆã€çš„æ¨™ç±¤æ¨£å¼ (ç°è‰²ã€è™›ç·šæ¡†) */
        .badge-pending {
            background: #F9FAFB;
            color: #6B7280;
            border: 1px dashed #D1D5DB;
            font-weight: normal;
        }

        .no-results {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
            font-size: 1.1rem;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: var(--primary-blue);
            font-weight: bold;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px 15px;
            }

            thead {
                display: none;
            }

            tr {
                display: flex;
                flex-direction: column;
                background: white;
                border: 2px solid #edf2f7;
                border-radius: 12px;
                margin-bottom: 20px;
                padding: 15px;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.03);
            }

            td {
                display: block;
                border: none;
                padding: 5px 0;
                text-align: left;
                width: 100%;
            }

            td:nth-child(5) {
                order: -1;
                text-align: center;
                margin-bottom: 10px;
                padding-bottom: 10px;
                border-bottom: 1px dashed #e2e8f0;
            }

            .time-badge {
                font-size: 1.1em;
                width: 100%;
                display: block;
                box-sizing: border-box;
                text-align: center;
            }

            td:nth-child(1),
            td:nth-child(2) {
                font-size: 0.9em;
                color: var(--text-muted);
                display: inline-block;
                width: auto;
                padding-right: 10px;
            }

            td:nth-child(3) {
                font-size: 1.2em;
                font-weight: bold;
                color: var(--primary-blue);
                margin-top: 5px;
            }

            td:nth-child(4) {
                color: #555;
                font-size: 1rem;
                line-height: 1.5;
                margin-top: 5px;
            }

            .filter-row,
            .search-group {
                flex-direction: column;
                align-items: stretch;
            }
        }

        /* --- å½ˆå‡ºè¦–çª—æ¨£å¼ --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(3px);
            /* èƒŒæ™¯æ¨¡ç³Šæ•ˆæœ */
        }

        .modal-container {
            background: white;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow-y: auto;
            /* å…§å®¹å¤ªé•·å¯æ»¾å‹• */
            animation: slideUp 0.3s ease-out;
        }

        .modal-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #f1f5f9;
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            font-size: 20px;
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            z-index: 10;
        }

        .modal-close-btn:hover {
            background: #e2e8f0;
            color: #ce0000;
        }

        .modal-body {
            padding: 0;
        }

        /* å…§å®¹å€å¡Š */

        /* è®“è¡¨æ ¼åˆ—è®Šæˆå¯é»æ“Šçš„æ¨£å­ */
        tbody tr {
            cursor: pointer;
            transition: transform 0.1s;
        }

        tbody tr:hover {
            background-color: #f8fafc;
            transform: scale(1.005);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>

<body>

    <div class="navbar">
        <div class="logo-text">ç¬¬28å±†é¦™æ¸¯é’å°‘å¹´ç§‘æŠ€å‰µæ–°å¤§è³½</div>
        <button class="menu-btn" onclick="toggleMenu()">â˜°</button>
    </div>

    <div class="overlay" id="overlay" onclick="toggleMenu()"></div>

    <div class="side-menu" id="sideMenu">
        <button class="close-btn" onclick="toggleMenu()">Ã—</button>
        <a href="index.html">ğŸ† å…¥åœç¸½è©•åå–®</a>
        <a href="awards.html">ğŸ¥‡ å¾—çåå–®</a>
        <a href="https://stic.newgen.org.hk" target="_blank">ğŸŒ å¤§è³½ç¶²ç«™</a>
        <a href="https://app.jotform.com/243098567658474" target="_blank">ğŸ“± æ–°ä¸€ä»£ App</a>
        <a href="https://stic.newgen.org.hk/è¯çµ¡æˆ‘å€‘/">ğŸ“§ è¯çµ¡æˆ‘å€‘</a>
    </div>

    <div class="container">
        <div class="header-title">
            <h1>é ’çå®‰æ’</h1>
            <p>ç¬¬28å±†é¦™æ¸¯é’å°‘å¹´ç§‘æŠ€å‰µæ–°å¤§è³½</p>
        </div>

        <div class="notice-box">
            <strong>ğŸ’¡ æŸ¥è©¢æŒ‡å¼•ï¼š</strong> è¼¸å…¥åƒè³½ç·¨è™Ÿï¼Œå³æ™‚æŸ¥è©¢æ‚¨çš„é ’çå„€å¼æˆ–å…¸ç¦®å‡ºå¸­æ™‚æ®µã€‚
        </div>

        <div class="search-section">
            <div class="filter-row">
                <select id="categorySelect" class="form-select" onchange="onCategoryChange(this.value)">
                    <option value="all">ğŸ“‚ æ‰€æœ‰åƒè³½çµ„åˆ¥ (å…¨éƒ¨)</option>
                </select>
            </div>
            <div style="text-align: center; font-size: 0.9em; color: #888; margin: 5px 0;">â€” æˆ– â€”</div>
            <div class="search-group">
                <select id="prefixSelect" class="prefix-dropdown" onchange="onInputStart()">
                    <option value="">é¦–å­—</option>
                </select>
                <input type="tel" id="numInput" class="number-input" placeholder="è¼¸å…¥4ä½æ•¸å­— (ä¾‹: 1974)" maxlength="4"
                    oninput="this.value=this.value.replace(/[^0-9]/g,''); onInputStart();">
                <button class="btn-search" onclick="filterData('byId')">æœå°‹ç·¨è™Ÿ</button>
                <button class="btn-reset" onclick="resetSearch()">é‡ç½®</button>
            </div>
        </div>

        <div id="loadingIndicator" class="loading">åŠ è¼‰ä¸­...</div>

        <div class="table-responsive" id="tableContainer" style="display: none;">
            <table id="resultsTable">
                <thead>
                    <tr>
                        <th width="15%">åƒè³½çµ„åˆ¥</th>
                        <th width="15%">åƒè³½ç·¨è™Ÿ</th>
                        <th width="20%">åƒè³½è€…å§“å</th>
                        <th width="25%">ä½œå“åç¨±</th>
                        <th width="25%">å‡ºå¸­æ™‚æ®µ</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
            <div id="noResults" class="no-results" style="display: none;">æ‰¾ä¸åˆ°ç›¸ç¬¦ç´€éŒ„ï¼Œè«‹æª¢æŸ¥åƒè³½ç·¨è™Ÿã€‚</div>
        </div>
    </div>

    <div id="detailModal" class="modal-overlay" onclick="closeModal(event)">
        <div class="modal-container" onclick="event.stopPropagation()">
            <button class="modal-close-btn" onclick="closeModal()">Ã—</button>
            <div id="modalContent" class="modal-body">
            </div>
        </div>
    </div>

    <script>
        function toggleMenu() {
            document.getElementById('sideMenu').classList.toggle('open');
            document.getElementById('overlay').classList.toggle('show');
        }

        let allData = [];
        // ä½¿ç”¨ Google Sheet ç™¼å¸ƒé€£çµ
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSQ1HDP4hGRakiDtICKljEtQSwyG5cuiLFlMqAW3ZlB7t3ITCl5QOH32rlLBr-3WJNUrdNVWxaaVfm4/pub?output=csv';
        let currentCategory = 'all';

        Papa.parse(csvUrl, {
            download: true,
            header: true,
            skipEmptyLines: true,
            complete: function (results) {
                allData = results.data;
                document.getElementById('loadingIndicator').style.display = 'none';
                document.getElementById('tableContainer').style.display = 'block';
                setupFilters(allData);
                renderTable(allData);
            },
            error: function (err) {
                document.getElementById('loadingIndicator').innerHTML =
                    '<div style="text-align:center; color:red;">' +
                    'âš ï¸ å°šæœªå…¬å¸ƒ<br>' +
                    '<button onclick="location.reload()" style="margin-top:10px; padding:8px 20px; border-radius:5px; border:1px solid #ccc; background:white;">é»æ­¤é‡æ–°æ•´ç†</button>' +
                    '</div>';
            }
        });

        /*
        const csvUrl = 'data.csv'; 
        let currentCategory = 'all';
    
        Papa.parse(csvUrl, {
            download: true,
            header: true,
            skipEmptyLines: true,
            complete: function(results) {
                allData = results.data;
                document.getElementById('loadingIndicator').style.display = 'none';
                document.getElementById('tableContainer').style.display = 'block';
                setupFilters(allData); 
                renderTable(allData);  
            }
        });
        */

        function setupFilters(data) {
            const categorySet = new Set();
            const prefixSet = new Set();
            data.forEach(row => {
                if (row['åƒè³½çµ„åˆ¥']) categorySet.add(row['åƒè³½çµ„åˆ¥'].trim());
                if (row['åƒè³½ç·¨è™Ÿ']) {
                    const prefixMatch = row['åƒè³½ç·¨è™Ÿ'].trim().match(/^[A-Za-z]+/);
                    if (prefixMatch) prefixSet.add(prefixMatch[0].toUpperCase());
                }
            });
            const catSelect = document.getElementById('categorySelect');
            catSelect.innerHTML = '<option value="all">ğŸ“‚ æ‰€æœ‰åƒè³½çµ„åˆ¥ (å…¨éƒ¨)</option>';
            categorySet.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                catSelect.appendChild(option);
            });
            const prefixSelect = document.getElementById('prefixSelect');
            Array.from(prefixSet).sort().forEach(prefix => {
                const option = document.createElement('option');
                option.value = prefix;
                option.textContent = prefix;
                prefixSelect.appendChild(option);
            });
        }

        function onCategoryChange(cat) {
            currentCategory = cat;
            document.getElementById('prefixSelect').value = '';
            document.getElementById('numInput').value = '';
            filterData('byCat');
        }

        function onInputStart() {
            document.getElementById('categorySelect').value = 'all';
            currentCategory = 'all';
        }

        function filterData(mode) {
            const prefix = document.getElementById('prefixSelect').value;
            const num = document.getElementById('numInput').value.trim();
            const searchId = (prefix + num).toUpperCase();
            const filtered = allData.filter(row => {
                if (searchId.length > 0) {
                    return row['åƒè³½ç·¨è™Ÿ'] && row['åƒè³½ç·¨è™Ÿ'].toUpperCase().includes(searchId);
                } else {
                    return currentCategory === 'all' || row['åƒè³½çµ„åˆ¥'] === currentCategory;
                }
            });
            renderTable(filtered);
        }

        function resetSearch() {
            document.getElementById('categorySelect').value = 'all';
            document.getElementById('prefixSelect').value = '';
            document.getElementById('numInput').value = '';
            currentCategory = 'all';
            filterData();
        }

        // é¡¯ç¤ºè©³ç´°è³‡è¨Šçš„å‡½æ•¸
        function showDetails(row) {
            const modal = document.getElementById('detailModal');
            const content = document.getElementById('modalContent');
            const session = row['é ’çæ™‚æ®µ'] ? row['é ’çæ™‚æ®µ'].trim() : '';

            // å§“åçµ„åˆ
            let names = [];
            if (row['ä¸­æ–‡å§“å'] && row['ä¸­æ–‡å§“å'].trim()) names.push(row['ä¸­æ–‡å§“å'].trim());
            if (row['å§“å1'] && row['å§“å1'].trim()) names.push(row['å§“å1'].trim());
            if (row['å§“å2'] && row['å§“å2'].trim()) names.push(row['å§“å2'].trim());
            if (row['å§“å3'] && row['å§“å3'].trim()) names.push(row['å§“å3'].trim());
            let displayName = names.join('ã€');

            let details = {
                title: "é ’çå…¸ç¦®",
                subTitle: "å‡ºå¸­é€šçŸ¥",
                regTime: "14:30",
                eventTimeLabel: "å…¸ç¦®",
                eventTime: "15:30 - 17:30",
                extraInfo: "", // ç”¨æ–¼æ”¾ã€Œè¨­å±•ã€æˆ–ã€Œæµç¨‹ã€çš„é¡å¤–è³‡è¨Š
                themeColor: "#ce0000", // é è¨­ç´…è‰²
                bgColor: "#fff5f5",    // é è¨­æ·ºç´…èƒŒæ™¯
                borderColor: "#ffcccc"
            };

            // ---------------------------------------------------------
            // æ ¸å¿ƒåˆ¤æ–·é‚è¼¯
            // ---------------------------------------------------------

            // 1. ğŸ† åµæ¸¬ã€Œè¨­å±•ã€å­—çœ¼
            if (session.includes('è¨­å±•')) {
                details.title = "é ’çå…¸ç¦® (è¨­å±•)";
                details.regTime = "13:45";
                details.eventTime = "15:30 - 17:30";

                details.extraInfo = `
                <tr>
                    <td colspan="2" style="padding-top:10px; font-size:14px; color:#ff6100; line-height:1.5;">
                        <strong>âœ¨ é‡è¦æç¤ºï¼š</strong><br>
                        æ•¬è«‹ã€€é–£ä¸‹å‡ºå¸­é ’çå…¸ç¦®ä¸¦<strong>è¨­å±•</strong>ã€‚<br>
                        å¤§æœƒå°‡å®‰æ’ä¸»ç¦®å˜‰è³“å’Œå‚³åª’åƒè§€å±•ä½ï¼Œå»ºè­°æå‰æº–å‚™ä»‹ç´¹å…§å®¹ã€‚
                    </td>
                </tr>
            `;
            }

            // 2. ğŸ“… é ’çå…¸ç¦®
            else if (session.includes('é ’çå…¸ç¦®')) {
                details.title = "é ’çå…¸ç¦®";
                details.regTime = "14:30";
                details.eventTime = "15:30 - 17:30";
            }

            // 3. â˜€ï¸ é ’çå„€å¼
            else if (session.includes('é ’çå„€å¼')) {
                details.title = "é ’çå„€å¼";
                details.eventTimeLabel = "æ™‚é–“";
                details.themeColor = "#003366";
                details.bgColor = "#f0f7ff";
                details.borderColor = "#cce5ff";

                // åˆ¤æ–·æ˜¯ç¬¬ä¸€ç¯€é‚„æ˜¯ç¬¬äºŒç¯€
                if (session.includes('ä¸€') || session.includes('1')) {
                    details.eventTime = "11:30 - 12:15";
                } else {
                    details.eventTime = "12:15 - 13:00";
                }

                details.regTime = "å„€å¼æ™‚é–“å…§å ±åˆ°";

                details.extraInfo = `
                <tr>
                    <td style="color: #666;" valign="top"><strong>æµç¨‹ï¼š</strong></td>
                    <td>å¾—çè€…æ–¼ç™»è¨˜è™•å ±åˆ°ï¼Œä¸¦ä¾å·¥ä½œäººå“¡æŒ‡ç¤ºé ˜å–çç›ƒåŠæ‹ç…§ç•™å¿µã€‚</td>
                </tr>
            `;
            }

            // å¦‚æœæ™‚æ®µæ˜¯ç©ºçš„ï¼Œä¸å½ˆå‡ºè¦–çª—
            if (!session) return;

            // ---------------------------------------------------------
            // HTML
            // ---------------------------------------------------------
            content.innerHTML = `
            <div style="background-color: #003366; padding: 25px 20px; text-align: center; border-radius: 12px 12px 0 0;">
                <h1 style="color: #ffffff; margin: 0; font-size: 20px; letter-spacing: 1px;">ç¬¬28å±†é¦™æ¸¯é’å°‘å¹´ç§‘æŠ€å‰µæ–°å¤§è³½</h1>
                <h2 style="color: #fecc11; margin: 5px 0 0 0; font-size: 18px; letter-spacing: 1px;">${details.title}</h2>
            </div>

            <div style="padding: 20px;">
                <p style="font-size: 16px; color: #333; margin-bottom: 20px; text-align: center;">
                    <strong>${displayName}</strong> åŒå­¸ï¼š<br>
                    <span style="color: #ff6100;"><strong>èª é‚€</strong></span>ã€€é–£ä¸‹å‡ºå¸­${details.title}ã€‚
                </p>

                <div style="background-color: ${details.bgColor}; border-left: 5px solid ${details.themeColor}; padding: 20px; border-radius: 4px; margin-bottom: 20px;">
                    <h3 style="margin: 0 0 15px 0; color: ${details.themeColor}; font-size: 18px; border-bottom: 1px solid ${details.borderColor}; padding-bottom: 10px;">
                        ğŸ“… å®‰æ’è©³æƒ…
                    </h3>
                    <table style="font-size: 15px; color: #333;" border="0" width="100%" cellspacing="0" cellpadding="5">
                        <tbody>
                            <tr>
                                <td style="color: #666;" valign="top" width="25%"><strong>æ—¥æœŸï¼š</strong></td>
                                <td width="75%"><strong>2026 å¹´ 3 æœˆ 22 æ—¥ (æ˜ŸæœŸæ—¥)</strong></td>
                            </tr>
                            <tr>
                                <td style="color: ${details.themeColor};" valign="top"><strong>å ±åˆ°ï¼š</strong></td>
                                <td style="color: ${details.themeColor}; font-weight: bold; font-size: 1.1em;">${details.regTime}</td>
                            </tr>
                            <tr>
                                <td style="color: #666;" valign="top"><strong>${details.eventTimeLabel}ï¼š</strong></td>
                                <td>${details.eventTime}</td>
                            </tr>
                            <tr>
                                <td style="color: #666;" valign="top"><strong>åœ°é»ï¼š</strong></td>
                                <td>
                                    é¦™æ¸¯æœƒè­°å±•è¦½ä¸­å¿ƒ 1 è™Ÿæ¼”è¬›å»³<br>
                                    <span style="font-size: 13px; color: #888;">(åœ°å€ï¼šé¦™æ¸¯ç£ä»”åšè¦½é“ 1 è™Ÿ L1)</span>
                                </td>
                            </tr>
                            
                            ${details.title.includes('å…¸ç¦®') ? `
                            <tr>
                                <td style="color: #666;" valign="top"><strong>åé¡ï¼š</strong></td>
                                <td>æ¯ä½å¾—çè€…å¯é‚€è«‹ <strong>1 ä½</strong> è€å¸«æˆ–å®¶é•·é€²å ´è§€ç¦®</td>
                            </tr>` : ''}

                            <tr>
                                <td style="color: #666;" valign="top"><strong>æœé£¾ï¼š</strong></td>
                                <td>å¾—çè€…å¿…é ˆç©¿è‘—ç”±å¤§æœƒæ´¾ç™¼çš„ä¸Šè¡£<br><span style="font-size:13px; color:#888;">(å·²æ–¼ç¸½è©•ç™»è¨˜æ™‚æ´¾ç™¼)</span></td>
                            </tr>

                            ${details.extraInfo}
                        </tbody>
                    </table>
                </div>

                <div style="background-color: #fffaf0; border: 1px solid #ffeeba; padding: 15px; border-radius: 6px; font-size: 14px; color: #856404; margin-bottom: 20px;">
                    <strong>ğŸ“¢ å¦‚æœªèƒ½å‡ºå¸­ï¼š</strong>
                    <p style="margin: 5px 0 0 0; line-height: 1.5;">
                        ç…©è«‹ã€€é–£ä¸‹é ˆæ–¼ <strong>4 æœˆ 30 æ—¥ (å››) 17:00 æˆ–ä¹‹å‰*</strong> è¦ªè‡¨
                        <a href="https://maps.app.goo.gl/Lech4SbJ3HsUj5Jw5" target="_blank"
                        rel="noopener noreferrer">æ²™ç”°æ²™è§’é‚¨é¦™æ¸¯è³‡å„ªæ•™è‚²å­¸è‹‘ 411 å®¤</a>é ˜å–çé …ã€‚å‰å¾€é ˜çå‰ï¼Œè«‹å…ˆè‡´é›» <a href="tel:+85227923639"
                        target="_blank" rel="noopener noreferrer">2792 3639</a> å‘æœ¬æœƒè·å“¡é ç´„ã€‚</p><br>
                        <span style="display: block; margin-top: 5px; font-weight: bold; color: #ce0000;">*é€¾æœŸçé …ä¸äºˆä¿ç•™</span>
                    </p>
                </div>
            </div>

            <div style="background-color: #003366; color: #ffffff; text-align: center; font-size: 13px; line-height: 1.6; padding: 20px; border-radius: 0 0 12px 12px;">
                <p style="margin: 0 0 10px 0;"><strong>é¦™æ¸¯æ–°ä¸€ä»£æ–‡åŒ–å”æœƒç§‘å­¸å‰µæ„ä¸­å¿ƒã€€è¬¹å•Ÿ</strong></p>
                <p style="margin: 0;">åœ°å€ï¼šæ–°ç•Œæ²™ç”°è§’é‚¨é¦™æ¸¯è³‡å„ªæ•™è‚²å­¸è‹‘ 411 å®¤</p>
                <p style="margin: 0;">é›»è©±ï¼š2792 3639 | å‚³çœŸï¼š2792 0286</p>
                <p style="margin: 0;">ç¶²å€ï¼š<a style="color: #aaccff; text-decoration: none;"
                    href="https://stic.newgen.org.hk/">https://stic.newgen.org.hk/</a></p>
                <p style="margin: 0;">é›»éƒµï¼š<a style="color: #aaccff; text-decoration: none;"
                    href="mailto:stic@newgen.org.hk">stic@newgen.org.hk</a></p>
                <p style="margin: 0;">Instagramï¼š<a style="color: #aaccff; text-decoration: none;"
                    href="https://www.instagram.com/hkngcasic/">@hkngcasic</a></p>
                <p style="margin: 10px 0 0 0; opacity: 0.6;">å¤§æœƒä¿ç•™æ˜¯æ¬¡æ¯”è³½ä¸€åˆ‡æœ€çµ‚æ±ºå®šæ¬Š</p>
            </div>
        `;

            // é¡¯ç¤ºå½ˆçª—
            modal.style.display = 'flex';
        }

        // é—œé–‰å½ˆçª—
        function closeModal(event) {
            if (event && event.target !== document.getElementById('detailModal') && event.target.className !== 'modal-close-btn') return;
            document.getElementById('detailModal').style.display = 'none';
        }

        function renderTable(data) {
            const tbody = document.getElementById('tableBody');
            const noResults = document.getElementById('noResults');
            const table = document.getElementById('resultsTable');
            tbody.innerHTML = '';
            if (data.length === 0) {
                noResults.style.display = 'block'; table.style.display = 'none'; return;
            }
            noResults.style.display = 'none'; table.style.display = 'table';

            data.forEach(row => {
                if (row['åƒè³½ç·¨è™Ÿ']) {
                    /*
                    let names = [];
                    if (row['ä¸­æ–‡å§“å']) names.push(row['ä¸­æ–‡å§“å'].trim());
                    if (row['å§“å1']) names.push(row['å§“å1'].trim());
                    if (row['å§“å2']) names.push(row['å§“å2'].trim());
                    if (row['å§“å3']) names.push(row['å§“å3'].trim());
                    let displayName = names.filter(Boolean).join('<br>');
                    */
                    let names = [];
                    if (row['ä¸­æ–‡å§“å'] && row['ä¸­æ–‡å§“å'].trim()) names.push(row['ä¸­æ–‡å§“å'].trim());
                    if (row['å§“å1'] && row['å§“å1'].trim()) names.push(row['å§“å1'].trim());
                    if (row['å§“å2'] && row['å§“å2'].trim()) names.push(row['å§“å2'].trim());
                    if (row['å§“å3'] && row['å§“å3'].trim()) names.push(row['å§“å3'].trim());
                    let displayName = names.join('ã€');
                    // --- ç©ºå€¼è‡ªå‹•è½‰ç‚ºã€Œè©³æƒ…ç¨å¾Œå…¬ä½ˆã€ ---
                    let sessionHtml = '';
                    let sessionText = row['é ’çæ™‚æ®µ'] ? row['é ’çæ™‚æ®µ'].trim() : '';

                    if (sessionText) {
                        // å¦‚æœ‰æ™‚é–“ï¼Œå°±é¡¯ç¤ºå½©è‰²æ¨™ç±¤
                        let badgeClass = 'badge-pending'; // é è¨­æ¨£å¼
                        if (sessionText.includes('é ’çå„€å¼') && (sessionText.includes('ä¸€') || sessionText.includes('1'))) {
                            badgeClass = 'badge-am1';
                        } else if (sessionText.includes('é ’çå„€å¼') && (sessionText.includes('äºŒ') || sessionText.includes('2'))) {
                            badgeClass = 'badge-am2';
                        } else if (sessionText.includes('é ’çå…¸ç¦®')) {
                            badgeClass = 'badge-pm';
                        }
                        sessionHtml = `<span class="time-badge ${badgeClass}">${sessionText}</span>`;
                    } else {
                        // ğŸŒŸ å¦‚æœé€™ä¸€æ ¼æ˜¯ç©ºçš„ï¼Œè‡ªå‹•é¡¯ç¤ºé€™è¡Œå­—
                        sessionHtml = `<span class="time-badge badge-pending">è©³æƒ…ç¨å¾Œå…¬ä½ˆ</span>`;
                    }
                    // ---------------------------------------------

                    const tr = document.createElement('tr');

                    if (sessionText) {
                        tr.onclick = () => showDetails(row);
                        tr.title = "é»æ“ŠæŸ¥çœ‹è©³ç´°å®‰æ’"; // æ»‘é¼ ç§»ä¸Šå»æœ‰æç¤º
                    } else {
                        tr.style.cursor = "default"; // æ²’è³‡æ–™æ™‚æ»‘é¼ ä¸è®Šæ‰‹å‹
                    }

                    tr.innerHTML = `
                    <td><span class="badge-group">${row['åƒè³½çµ„åˆ¥'] || ''}</span></td>
                    <td><strong>${row['åƒè³½ç·¨è™Ÿ'] || ''}</strong></td>
                    <td style="line-height: 1.4;">${displayName}</td> 
                    <td>${row['ä½œå“åç¨±'] || ''}</td>
                    <td>${sessionHtml}</td>
                `;
                    tbody.appendChild(tr);
                }
            });
        }

        document.getElementById('numInput').addEventListener('keypress', e => {
            if (e.key === 'Enter') filterData('byId');
            document.getElementById('numInput').blur(); // æ”¶èµ·æ‰‹æ©Ÿéµç›¤
        });
    </script>

</body>

</html>